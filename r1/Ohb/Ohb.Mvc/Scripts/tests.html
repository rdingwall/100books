<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
    <title></title>
    <script src="http://cdnjs.cloudflare.com/ajax/libs/less.js/1.1.3/less-1.1.3.min.js"></script>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.0/jquery.min.js" type="text/javascript"></script>
    <script src="http://ajax.cdnjs.com/ajax/libs/modernizr/1.7/modernizr-1.7.min.js"
        type="text/javascript"></script>
    <script src="http://ajax.cdnjs.com/ajax/libs/underscore.js/1.1.4/underscore-min.js"
        type="text/javascript"></script>
    <script src="http://ajax.cdnjs.com/ajax/libs/backbone.js/0.3.3/backbone-min.js" type="text/javascript"></script>
    <script src="https://raw.github.com/andyet/ICanHaz.js/master/ICanHaz.min.js" type="text/javascript"></script>
    <script src="ohb.js" type="text/javascript"></script>
    <link rel="stylesheet" href="http://code.jquery.com/qunit/git/qunit.css" type="text/css"
        media="screen" />
    <script type="text/javascript" src="http://code.jquery.com/qunit/git/qunit.js"></script>
    <script type="text/javascript">

        

        $(document).ready(function () {

            module("When mapping google book search results");

            test("It should include the book's subtitle", function () {
                assertBookMapping('abYKXvCwEToC', 
                "Harry Potter: the story of a global business phenomenon",
                "Susan Gunelius",
                "http://bks6.books.google.co.uk/books?id=abYKXvCwEToC&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api");
            });

            test("It should list multiple authors", function () {
                assertBookMapping('GGpXN9SMELMC',
                "Head First design patterns",
                "Eric Freeman, Elisabeth Freeman, Kathy Sierra, Bert Bates",
                "http://bks9.books.google.co.uk/books?id=GGpXN9SMELMC&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api");
            });

            test("It should handle books without thumbnails", function () {
                assertBookMapping('_XDFAAAACAAJ',
                "Design Patterns: Elements of Reusable Object-Oriented Software with Applying Uml and Patterns:An Introduction to Object-Oriented Analysis and Design and the Unified Process",
                "Gamma, Larman",
                null);
            });

            test("It should handle books with no authors", function () {
                assertBookMapping('3zgFSQAACAAJ',
                "The Girl With the Dragon Tattoo",
                null,
                "http://bks1.books.google.co.uk/books?id=3zgFSQAACAAJ&printsec=frontcover&img=1&zoom=5&source=gbs_api");
            });

            

        });



        function assertBookMapping(googleBookId, title, authors, smallThumbnailUrl) {
            $.getJSON('https://www.googleapis.com/books/v1/volumes/' + googleBookId + '?callback=?',
                function (data) {
                    var searchResult = SearchResult.fromGoogle(data);

                    start();

                    equal(searchResult.get('title'), title);
                    equal(searchResult.get('authors'), authors);
                    equal(searchResult.get('smallThumbnailUrl'), smallThumbnailUrl);
                })
                .error(function () {
                    start();
                    throw "failed";
                });

            stop();

            expect(3);
        }


    </script>
</head>
<body>
    <h1 id="qunit-header">
        QUnit example</h1>
    <h2 id="qunit-banner">
    </h2>
    <div id="qunit-testrunner-toolbar">
    </div>
    <h2 id="qunit-userAgent">
    </h2>
    <ol id="qunit-tests">
    </ol>
    <div id="qunit-fixture">

        
   

    </div>
</body>
</html>
